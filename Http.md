#### URL

**统一资源定位符** (Uniform Resource Locator, URL) 是互联网上标准资源的地址。互联网上的每个文件都有一个唯一的 URL，它包含的信息指出文件的位置以及浏览器应该怎么处理它。

URL的一般语法规范为：

```
 protocol://host[:port]/path/[?query]#fragment

 http://www.itcast.cn/index.html?name=andy&age=18#link
```

其中：

| 组成     | 说明                                                         |
| -------- | ------------------------------------------------------------ |
| prorocol | 通信协议，如http、https、ftp、maito等                        |
| host     | 主机（域名），如www.baidu.com                                |
| port     | 端口号，可选，省略则使用方案的默认端口，如http默认端口为80   |
| path     | 路径，由零或多个'/'符号隔开的字符串，一般用来表示主机上的一个目录或文件地址 |
| query    | 参数，以键值对的方式，通过&符号分隔开来                      |
| fragment | 片段，#后面的内容，常见于链接 锚点                           |



#### 浏览器输入URL后，到响应的过程：

1. redirect：跳转
2. Appcache：缓存（查找是否有缓存资源）
3. 域名解析为IP地址（DNS解析）
4. 创建TCP链接
5. request发送请求
6. response响应



#### 一次完整的HTTP事务流程：

1. 域名解析
2. 发起TCP三次握手
3. 建立TCP连接后发送HTTP请求
4. 服务器响应HTTP请求，浏览器得到HTML代码
5. 浏览器解析HTML代码，并请求HTML代码中的资源
6. 浏览器对页面进行渲染呈现给用户
7. 连接结束



#### 域名解析IP地址

从网址到IP地址的转换，称为**DNS解析**，DNS解析是一个递归查询的过程，具体步骤如下（以www.google\.com为例）：

1. 首先在**本地域名服务器**（最近的一台DNS服务器）中查询IP地址

2. 如果没有找到，本地域名服务器会向**根域名服务器**发送一个请求

3. 如果根域名服务器中也不存在该域名，但判定这个域名属于**“com”域**，则本地域名服务器会向**com顶级域名服务器**发送一个请求

4. 如果com顶级域名服务器没有找到该域名，但判定这个域名属于**“google.com”域**，则本地域名服务器会向**google.com域名服务器**发送一个请求，以此类推

5. 直到本地域名服务器得到域名对应的IP地址，并**将其缓存到本地**，供下次查询使用

6. 综上，网址的解析过程为.->.com->google.com->www.google\.com。





![](./images/HTTP/三次握手四次挥手.png)

**上图部分标志说明：**

（1）**ACK**：TCP规定，只有当ACK=1时有效，也规定连接建立后所有发送的报文的ACK必须为1

（2）**SYN（SYNchronization）**：在连接建立时用来同步序号。当SYN=1而ACK=0时，表明这个是一个连接请求报文。对方若同意建立连接，则响应报文中SYN=1，ACK=1。因此，SYN置1表示这是一个连接请求或连接接受报文。

（3）**FIN（finish）**：终结的意思，用来释放一个连接。当FIN=1时，表明此报文段的发送方的数据已经发送完毕，并请求释放连接。

#### Tcp三次握手

三次握手的**必要性**：为了保证**服务器能接收到客户端的信息并做出正确的应答**而进行前两次（第一次和第二次）握手，为了保证**客户端能够接收到服务端的信息并能做出正确的应答**而进行后两次（第二次和第三次）握手。

（1）第一次握手：建立连接。客户端发送连接请求报文段，将SYN位置1，序列号seq（sequence number）为x；然后，客户端进入SYN_SEND状态，等待服务器的确认。

（2）第二次握手：服务器收到SYN报文段。服务器收到客户端的SYN报文段，需要对这个SYN报文段进行确认，ACK位置1，确认号ack（acknowledgement number）为x+1；同时，自己还要发送SYN请求信息，将SYN位置1，序列号seq为y；服务器将上述SYN+ACK报文段一并发送给客户端，此时服务器进入SYN_RECV状态。

（3）第三次握手：客户端收到服务器的SYN+ACK报文段。然后将确认号ack设置为y+1，向服务器发送ACK报文段。这个报文段发送完毕后，客户端和服务器都进入ESTABLISHED状态，完成TCP三次握手，之后可以开始传数据。



#### 四次挥手

当客户端和服务器通过三次握手建立了TCP连接之后，当数据传输完毕，就要断开TCP连接，这个过程称为四次挥手。四次挥手说明：

（1）第一次挥手：主机1（可以是客户端，也可以是服务器）设置序列号seq为u，向主机2发送一个FIN报文段；此时，主机1进入FIN_WAIT状态，这表示主机1没有数据要发送给主机2了。

（2）第二次挥手：主机2收到了主机1发送的FIN报文段，向主机1回复一个ACK报文段，确认号ack为u+1，序列号seq为v；主机2进入CLOSE_WAIT状态；主机1收到主机2发送的ACK报文段之后，进入FIN_WAIT_2状态。

（3）第三次挥手：主机2向主机1发送FIN报文段，设置序列号seq为w，确认号ack为u+1，请求关闭连接，同时主机2进入LAST_ACK状态

（4）第四次挥手：主机1收到主机2发送的FIN报文段，向主机2发送ACK报文段，确认号ack为w+1，序列号seq为u+1，然后主机1进入TIME_WAIT状态；主机2收到主机1的ACK报文段以后，就关闭连接；此时，主机1等待2MSL（MSL，最长报文段寿命）后依然没有收到回复，则证明服务端已经正常关闭，那么主机1也可以关闭连接了。





#### HTTP状态码及其作用

**HTTP状态码分类：**

（1）1**：信息，服务器收到请求，需要请求者继续执行操作

（2）2**：成功，操作被成功接收并处理

（3）3**：重定向，需要进一步的操作以完成请求

（4）4**：客户端错误，请求包含语法错误或者无法完成请求

（5）5**：服务器错误，服务器在处理请求的过程中发生了错误

**常见的HTTP状态码：**

200——OK，请求成功
301——Moved Permanently，资源（网页等）被永久转移到其他URL
302——Found，307——Temporary Redirect，临时重定向，请求的文档被临时移动到别处
304——Not Modified，未修改，表示客户端缓存的版本是最近的
401——Unauthorized，请求要求用户的身份认证
403——Forbidden，禁止，服务器理解客户端请求，但是拒绝处理此请求，通常是权限设置所致
404——Not Found，请求的资源（网页等）不存在
500——Internal Server Error——内部服务器错误
502——Bad Gateway，充当网关或代理的服务器从远端服务器接收到了一个无效的请求
504——Gateway Time-out，充当网关或代理的服务器，未及时从远端服务器获取请求



#### TCP/IP四层协议体系结构？

由上至下顺序为：

（1）应用层（FTP、Telnet、SMTP、RIP、NFS、DNS）

（2）运输层（TCP、UDP）

（3）网际层（IP、ICMP、ARP、RARP）

（4）网络接口层



#### 五层协议体系结构？

（1）应用层（HTTP、FTP）

（2）运输层（TCP、UDP）

（3）网络层（逻辑关系）

（4）数据链路层（电路连接）

（5）物理层（电脑硬件设备）



#### OSI的七层体系结构？

（1）应用层

（2）表示层

（3）会话层

（4）运输层

（5）网络层

（6）数据链路层

（7）物理层



#### HTTP和HTTPS的区别

HTTP（Hyper Text Transfer Protocol，超文本传输协议）被用于在web浏览器和网站服务器之间传递信息，HTTP协议以明文的方式发送内容，不提供任何方式的数据加密，如果攻击者截取了web浏览器和网站服务器之间的传输报文，就可以直接读懂其中的信息，因此，HTTP协议不适合传输一些敏感信息，比如：信用卡号，密码等支付信息。

HTTPS（Hyper Text Transfer Protocol over Secure Socket Layer，安全套接字超文本传输协议），为了数据传输的安全，HTTPS在HTTP的基础上加入了SSL/TLS，依靠证书来验证服务器的身份，并为浏览器和服务器之间的通信加密。其中SSL（Secure Socket Layer，安全套接层），TLS（Transport Layer Securit，传输层安全协议），SSL 3.0和TLS 1.0差别很小，在HTTPS通信中具体使用哪一个还要看客户端和服务端的支持程度，二者在网络模型中位于哪一层？

**区别：**

（1）HTTPS协议需要CA申请证书，一般免费证书比较少，所以需要一定费用

（2）HTTP是超文本传输协议，信息室明文传输，HTTPS则是具有安全性的SSL加密传输协议

（3）HTTP和HTTPS使用的是完全不同的连接方式，使用的端口号也不一样，前者是80，后者是443

（4）HTTP连接很简单，是无状态的；HTTPS协议是由HTTP+SSL协议构建的可进行加密传输、身份认证的网络协议，比较安全。

（5）谷歌搜索引擎算法中，比起同等HTTP网站，采用HTTPS加密的网站在搜索结果中排名会更高



#### 客户端使用HTTPS方式与web服务器通信的步骤：

（1）客户使用HTTPS的URL访问web服务器，要求与web服务器建立SSL连接

（2）web服务器收到客户端请求后，将网站的证书信息（证书中包含公钥）传送一份给客户端

（3）客户端的浏览器与web服务器开始协商SSL连接的安全等级，也就是信息的加密等级

（4）客户端的浏览器根据双方同意的安全等级，建立会话秘钥，然后利用网站的公钥将会话秘钥加密，并传送给网站

（5）web服务器利用自己的私钥解密出会话秘钥

（6）web服务器利用会话秘钥加密与客户端之间的通信



#### 如何从HTTP切换到HTTPS？

（1）需要将页面中所有的链接（例如js,css,图片等链接）都由http改为https

（2）一般情况下会建议保留HTTP，所以在切换的时候可以做HTTP和HTTPS的兼容，具体实现方式是：去掉页面连接中的http头部，这样恶意自动匹配HTTP头和HTTPS头



















